
---
title: "PAC3"
output: html_notebook
---

## Exercici 1

```{r Exercici 1}
set.seed(100) # Estableix una llavor per a la generaci´o de nombres aleatoris, assegurant que els resultats siguin reproduïbles.→
n_ciutats <- 20 # Defineix el nombre de ciutats que es crearan, en aquest cas, 15.
ciutats <- data.frame( # Crea un data frame anomenat "ciutats"
  nom = paste0("Ciutat ", LETTERS[1:n_ciutats]), # Genera noms per a les ciutats utilitzant les lletres majúscules (Ciutat A, Ciutat B, etc.) 
  longitud = runif(n_ciutats, -20, 20), # Genera longituds aleatòries per a les ciutats dins del rang de -20 a 20.
  latitud = runif(n_ciutats, 10, 50), # Genera latituds aleatòries per a les ciutats dins del rang de 10 a 50.→
  poblacio = sample(10000:100000, n_ciutats, replace = TRUE) # Genera poblacions aleatòries per a les ciutats dins del rang de 10000 a 100000, permetent valors repetits (replace = TRUE).
)

# Instal·lem el paquet
if (!require(ggplot2)) {
  install.packages("ggplot2", dependencies = TRUE)
}

# Carreguem paquet
library(ggplot2)

# Plot bàsic de punts amb latitud i longitud
ggplot(ciutats, aes(x = longitud, y = latitud)) +
geom_point() +
labs(title = "Localització de les Ciutats", x = "Longitud", y = "Latitud")


# Crea un plot de dispersió de longitud i latitud on la mida dels punts és proporcional a la població de cada ciutat
ggplot(ciutats, aes(x = longitud, y = latitud, size = poblacio / 1e3)) +
  geom_point() +
  labs(title = "Localització de les Ciutats", x = "Longitud", y = "Latitud", size = "Població (milers)") +
  scale_size_continuous(range = c(1, 10)) # Ajusta la mida dels punts per a una millor visualització```
```


## Exercici 2

```{r Exercici 2}

#Utilitzant el conjunt de dades de ciutats creat anteriorment:
# - Calculem el centroide de les ciutats
centroides <- data.frame(
  longitud = mean(ciutats$longitud),
  latitud = mean(ciutats$latitud)
)

# - Calculem el centre mitjà ponderat, on les coordenades es ponderen per la població de cada ciutat
centre_ponderat <- data.frame(
  longitud = sum(ciutats$longitud * ciutats$poblacio) / sum(ciutats$poblacio),
  latitud = sum(ciutats$latitud * ciutats$poblacio) / sum(ciutats$poblacio)
)

# - Creem un gràfic de dispersió amb ggplot2 que mostri la localització de les ciutats i afegiu també punts per al centroide i el centre mitjà ponderat.
# Gràfic de dispersió amb ggplot2
ggplot() +
  geom_point(data = ciutats, aes(x = longitud, y = latitud, size = poblacio / 1e3, shape = "Ciutats"), color = "blue", alpha = 0.6) + # Punts per a les ciutats
  geom_point(data = centroides, aes(x = longitud, y = latitud, shape = "Centroide"), color = "red", size = 4) + # Punt per al centroide
  geom_point(data = centre_ponderat, aes(x = longitud, y = latitud, shape = "Centre Mitjà Ponderat"), color = "green", size = 4) + # Punt per al centre mitjà ponderat
  scale_shape_manual(
    values = c("Ciutats" = 16, "Centroide" = 17, "Centre Mitjà Ponderat" = 18), # Assigna formes personalitzades
    name = "Tipus de Punt" # Nom de la llegenda
  ) +
  labs(
    title = "Localització de les Ciutats amb Centroide i Centre Mitjà Ponderat",
    x = "Longitud",
    y = "Latitud",
    size = "Població (milers)"
  ) +
  scale_size_continuous(range = c(1, 10)) + # Ajusta la mida dels punts
  theme_minimal() # Tema minimalista per al gràfic
```